apiVersion: '2021-10-01'
location: westeurope
name: dqdemocontainer
identity:
  type: UserAssigned
  userAssignedIdentities: 
    '/subscriptions/f0ccb1cf-bed6-48ee-9973-fab077ade488/resourcegroups/ContainerDemo/providers/Microsoft.ManagedIdentity/userAssignedIdentities/DQDemoContainer':
      clientId: "3522948f-901e-4ab4-aff9-d9f54305ce00"
      principalId: '08ff088d-5a33-4ab4-8fa5-f7ad2cd9438e'
properties:
  imageRegistryCredentials:
  - server: demoregistrydq.azurecr.io
    identity: "/subscriptions/f0ccb1cf-bed6-48ee-9973-fab077ade488/resourcegroups/ContainerDemo/providers/Microsoft.ManagedIdentity/userAssignedIdentities/DQDemoContainer"
  sku: Standard
  containers:
  - name: fastapi
    properties:
      image: demoregistrydq.azurecr.io/myfastapi:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
      - port: 8000
  - name: caddy-sidecar
    properties:
      image: demoregistrydq.azurecr.io/mycaddy:latest
      resources:
        requests:
          cpu: 1
          memoryInGb: 1.5
      ports:
      - port: 80
      - port: 443
  osType: Linux
  ipAddress:
    type: Public
    ports:
    - protocol: tcp
      port: 80
    - protocol: tcp
      port: 443
tags: {exampleTag: tutorial}
type: Microsoft.ContainerInstance/containerGroups
